<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>my node proxy</title>
    <link rel="stylesheet" href="index.css"/>
</head>
<body>
<h2 style="text-align: center">my node proxy</h2>
<div class="section">
    <div class="column" data-div="groups-div">
        col1
    </div><!--
    --><div class="column" data-div="group-div">
        col2
    </div><!--
    --><div class="column" data-div="websites-div">
        col3
    </div><!--
    --><div class="column" data-div="website-div">
        col4
    </div>
</div>
<div id="div-websites"></div>

We are using node <script>document.write(process.versions.node)</script>,
Chrome <script>document.write(process.versions.chrome)</script>,
and Electron <script>document.write(process.versions.electron)</script>.
<script type="text/javascript">
    window.$ = window.jQuery = require('jquery');
    $(document).ready(function () {
        // Variables
        var groupsDiv = $('div[data-div="groups-div"]');
        var websitesDiv = $('div[data-div="websites-div"]');
        var websiteDiv = $('div[data-div="website-div"]');
        var groupDiv = $('div[data-div="group-div"]');

        // Get all groups.
        $.ajax({
            url: 'http://127.0.0.1:8080/get_groups',
            type: "get",
            contentType: "application/json",
            success: function (response){
                let resultHtml = '<h5>Groups List</h5><ul>';
                $.each(JSON.parse(response), function(key, value) {
                    resultHtml += '<li class="groupItem" data-group-id="'+value.id+'">'+value.name+'</li>';
                });
                resultHtml += '</ul>';
                groupsDiv.html(resultHtml);
                addEventsForGroupItems();
            },
            error: function (error) {
                alert(JSON.stringify(error));
            }
        });

//        For dynamically added DOM
        function addEventsForGroupItems() {
//            Get all websites of a group after click on that.
            $('li.groupItem').on('click', function () {
                let groupId = $(this).attr('data-group-id');
                let groupName = $(this).text();
                $.ajax({
                    url: 'http://127.0.0.1:8080/get_websites/'+groupId,
                    type: "get",
                    contentType: "application/json",
                    success: function (response){
                        let resultHtml = '<h5>Websites List of<br/>'+groupName+'</h5><ul>';
                        $.each(JSON.parse(response), function(key, value) {
                            resultHtml += '<li class="websiteItem" data-website-id="'+value.id+'">'+value.address+'</li>';
                        });
                        resultHtml += '</ul>';
                        websitesDiv.html(resultHtml);
                    },
                    error: function (error) {
                        alert(JSON.stringify(error));
                    }
                });
                $.ajax({
                    url: 'http://127.0.0.1:8080/get_group/'+groupId,
                    type: "get",
                    contentType: "application/json",
                    success: function (response){
                        let resultHtml = '<h5>'+groupName+'</h5>';
                        let group = JSON.parse(response);
                        resultHtml += '<p>Data Usage:<br/>'+group.dataReceived+' Bytes</p>';

                        resultHtml += '<div class="btnDelete" data-div="delete-group" data-group-id="'+group.id+'">Delete</div>';

                        resultHtml += '<div>';
                        resultHtml += '<span>name: </span><input name="name" data-input="edit-group-name"/>';
                        resultHtml += '</div>';
                        resultHtml += '<div class="btnEdit" data-div="edit-group" data-group-id="'+group.id+'">Edit</div>';

                        resultHtml += '<div>';
                        resultHtml += '<span>name: </span><input name="name" data-input="add-group-name"/>';
                        resultHtml += '</div>';
                        resultHtml += '<div class="btnAdd" data-div="add-group" data-group-id="'+group.id+'">Add</div>';

                        groupDiv.html(resultHtml);
                    },
                    error: function (error) {
                        alert(JSON.stringify(error));
                    }
                });
            });
        }





        $('#websites').on('click', function () {
            $.ajax({
                url: 'http://127.0.0.1:8080/get_groups',
                type: "get",
                contentType: "application/json",
                success: function (response){
                    $('#div-websites').text(response);
                },
                error: function (error) {

                }
            });
        });
        $('#groups').on('click', function () {
            let request = {
                id:7,
                address:'asriran2.com',
                group_id: 2
            };
            $.ajax({
                url: 'http://127.0.0.1:8080/edit_website',
                type: "put",
                contentType: "application/json",
                dataType:'json',
                data: JSON.stringify(request),
                success: function (response){

                },
                error: function (error) {

                }
            });
        });
    });
</script>
</body>
</html>